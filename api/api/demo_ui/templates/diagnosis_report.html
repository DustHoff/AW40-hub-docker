{% extends "base.html" %}

{% block sidebar %}
<a href="/ui">Anmeldung Werkstatt</a>
<a href="/ui/{{ request.path_params['workshop_id'] }}/cases">Fälle</a>
<a href="/ui/{{ request.path_params['workshop_id'] }}/cases/{{ case_id }}" style="margin-left: 10px;">Ausgewählt: {{ case_id }}</a>
<a href="#" style="margin-left: 20px;"><b>Diagnose</b></a>
{% endblock %}

{% block content %}
  <h1>
    Diagnose Report
    <a class="linkbutton" href="/ui/{{ request.path_params['workshop_id'] }}/cases/{{ case_id }}">Zurück zum Fall</a>
  </h1>
  <hr>
  <p><b>Fall:</b> {{ case_id }}</p>
  <p>
    <b>Status der Diagnose:</b> {{ diag_status|schema_format("diagnosis_status") }}
    <button onClick="window.location.reload();" style="margin-left:10px">&#128472 Aktualisieren</button>
  </p>
  <hr>
  {% for todo in todos %}
    <div class="todo" background-color:red>
      <p><b>{{ todo["instruction"] }}</b></p>
    </div>
  {% endfor %}

  <h2> State Machine Log </h2>
  <table>
    <tr>
      <th>Nachricht</th>
      <th>Anhang</th>
      {% for entry in state_machine_log %}
        <tr>
          <td>{{ entry["message"] }}</td>
          <td>
          {% if entry["attachment"] %}
            <a href={{ entry["attachment"] }}>
              <img src={{ entry["attachment"] }} style="width:150px;height:150px;">
            </a>
          {% endif %}
          </td>
        </tr>
      {% endfor %}
  </table>

{% endblock %}